# Криптография
В данном репозитории хранится библиотека с функционалом для шифрования и расшифрования файлов.

---

## Используемые алгоритмы
### Симметричные алгоритмы шифрования
- DES
- DEAL, поддержка ключей по 128, 192, 256 бит
- 3DES, поддержка EDE и ключей по 7 байт каждый
- AES (Rijndael), поддержка блоков и ключей по 128, 192, 256 бит
- FROG

### Потоковые алгоритмы шифрования
- RC4

### Асимметричные алгоритмы шифрования
- RSA

### Протоколы
- Протокол Диффи-Хеллмана
---
## Описание функционала
Для удобства использования данной библиотеки были написаны контексты, помогающие быстро и удобно зашифровывать и 
расшифровывать файлы и блоки байтов.

Контекст симметричного шифрования включает в себя различные методы набивки и режимы шифрования. Поддержка алгоритма 
шифрования контекстом осуществляется с помощью интерфейсов, требующих от реализации алгоритма определенных методов и полей. 

### Контексты
- **SymmetricAlgorithmContext** - для симметричных алгоритмов шифрования
- **AsymmetricAlgorithmContext** - для асимметричных алгоритмов шифрования
- **StreamCipherContext** - для потоковых алгоритмов шифрования

### Интерфейсы
- **ISymmetricKeyAlgorithm** - основа для симметричных алгоритмов шифрования. Поддерживает методы SetKey, Encrypt и Decrypt. Имеет 
поле BlockSize, используемое для обозначения размера блока для правильного разбиения
- **IKeyExpander** - расширение ключей на раунды для симметричных алгоритмов
- **ICipherTransform** - шифрующее преобразование для симметричных алгоритмов
- **IAsymmetricKeyAlgorithm** - основа для асимметричных алгоритмов шифрования, также поддерживает методы Encrypt и Decrypt, 
а так же имеет поля для размера ключа и проверки его наличия
- **IPrimeTest** - вероятностный тест на простоту, содержит метод IsProbablyPrime, который проверяет число на простоту, а так же
поля ActualProbability, IterationsCount
- **IAsymmetricKeyGenerator** - генератор ключей для асимметричных алгоритмов

### Методы набивки
- **Zeros** - набивка нулями
- **ANSI X.923** - набивка нулями, кроме последнего - оно устанавливается как количество недостающих битов
- **PKCS-7** - набивка с помощью количества недостающих битов
- **ISO 10126** - набивка случайными числами, кроме последнего - оно устанавливается как количество недостающих битов

### Режимы шифрования
- **ECB** (Electronic Codebook) - шифрование каждого блока отдельно
- **CBC** (Cipher Block Chaining) - использование IV (Initialization Vector) для передачи в следующий цикл шифрования
- **PCBC** (Propagating Cipher Block Chaining)
- **CFB** (Cipher Feedback)
- **OFB** (Output Feedback)
- **CTR** (Counter)
- **Random Delta**

Описание и подробные схемы всех режимов можно посмотреть на [русскоязычной](https://ru.wikipedia.org/wiki/%D0%A0%D0%B5%D0%B6%D0%B8%D0%BC_%D1%88%D0%B8%D1%84%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F) и [англоязычной](https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation) википедиях.

### Особенности реализации алгоритмов
#### RSA
- Работает с ключами любой заданной длины;
- Встроена защита от атаки Ферма и атаки Винера;
- Реализована атака Винера отдельным классом, её можно протестировать, если включить уязвимость к атаке Винера в конструкторе RSA;
- Присутствуют различные вероятностные тесты простоты: тест Ферма, тест Соловея-Штрассена, тест Миллера-Рабина;
- Дешифрование оптимизировано с помощью применения алгоритма Гарнера, основанного на Китайской теореме об остатках;
- В качестве паддинга используется PKCS#1 v1.5;
- Для оптимизации проверки на простоту, используется предопределенный массив малых простых чисел;
- Дешифрующая экспонента d находится через расширенный алгоритм Евклида.

#### Rijndael (AES)
- Основан на поле Галуа (Galois Field) $GF(2^8)$ (отдельный класс в Utility);
- Работает с любыми неприводимыми полиномами;
- Для выбора неприводимого полинома можно использовать поле `AvailablePolynomials`;
- Стандартный неприводимый полином $11B_{16}$ = $x^8 + x^4 + x^3 + x + 1$;
- Генерация S-Box улучшена с помощью отложенной инстанциации через `Lazy<T>` в классе `RijndaelSBox`.

#### 